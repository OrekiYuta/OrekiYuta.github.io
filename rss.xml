<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Canoe</title>
  
  <subtitle>「ろくでなし」</subtitle>
  <link href="/rss.xml" rel="self"/>
  
  <link href="http://www.orekiyuta.cn/"/>
  <updated>2021-04-09T13:59:57.007Z</updated>
  <id>http://www.orekiyuta.cn/</id>
  
  <author>
    <name>Orekiyuta</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>try Flutter</title>
    <link href="http://www.orekiyuta.cn/archives/tryFlutter/"/>
    <id>http://www.orekiyuta.cn/archives/tryFlutter/</id>
    <published>2021-04-09T12:39:03.000Z</published>
    <updated>2021-04-09T13:59:57.007Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Get-started"><a href="#Get-started" class="headerlink" title="Get started"></a>Get started</h2><ul><li>get SDK 👉<a href="https://flutter.dev/docs/development/tools/sdk/releases" target="_blank" rel="noopener">Flutter SDK releases</a></li><li>update system path</li><li><img src="/images/tryflutter/Snipaste_2021-04-09_20-44-44.png" alt></li><li>update user path</li><li><img src="/images/tryflutter/Snipaste_2021-04-09_20-45-40.png" alt></li><li><img src="/images/tryflutter/Snipaste_2021-04-09_20-46-04.png" alt></li><li><code>flutter doctor</code></li><li><img src="/images/tryflutter/Snipaste_2021-04-09_20-50-12.png" alt></li><li>👉<a href="https://developer.android.com/studio/index.html" target="_blank" rel="noopener">Android Studio</a></li></ul><p>## </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Get-started&quot;&gt;&lt;a href=&quot;#Get-started&quot; class=&quot;headerlink&quot; title=&quot;Get started&quot;&gt;&lt;/a&gt;Get started&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;get SDK 👉&lt;a href=&quot;https://f
      
    
    </summary>
    
    
    
      <category term="Flutter" scheme="http://www.orekiyuta.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Acer Bios Reset PW</title>
    <link href="http://www.orekiyuta.cn/archives/acerBiosResetPW/"/>
    <id>http://www.orekiyuta.cn/archives/acerBiosResetPW/</id>
    <published>2021-03-17T12:06:09.000Z</published>
    <updated>2021-04-09T13:59:43.437Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Scene"><a href="#Scene" class="headerlink" title="Scene"></a>Scene</h2><ul><li>Acer 主板进入 bios 需要密码，但是又不知道密码<a id="more"></a></li></ul><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ul><li><img src="/images/acerBiosResetPW/01.jpg" alt></li><li>先输入三次任意密码，然后出现下面的选项</li><li><img src="/images/acerBiosResetPW/02.jpg" alt></li><li>进入第一个选项</li><li>然后看到 Enter Unlock Password(key:xxxxx)</li><li>进入 <a href="https://bios-pw.org/" target="_blank" rel="noopener">https://bios-pw.org/</a> </li><li>输入上面的 key</li><li><img src="/images/acerBiosResetPW/04.png" alt></li><li>取得对应的 code 并输入</li></ul><h3 id="取消-bios-密码"><a href="#取消-bios-密码" class="headerlink" title="取消 bios 密码"></a>取消 bios 密码</h3><ul><li><img src="/images/acerBiosResetPW/03.jpg" alt></li><li>第一行输入刚才取得的 code , 其余两行直接回车</li><li>保存设置即可</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Scene&quot;&gt;&lt;a href=&quot;#Scene&quot; class=&quot;headerlink&quot; title=&quot;Scene&quot;&gt;&lt;/a&gt;Scene&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Acer 主板进入 bios 需要密码，但是又不知道密码
    
    </summary>
    
    
    
      <category term="Windows" scheme="http://www.orekiyuta.cn/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>The rain turned fine</title>
    <link href="http://www.orekiyuta.cn/archives/TheRainTurnedFine/"/>
    <id>http://www.orekiyuta.cn/archives/TheRainTurnedFine/</id>
    <published>2021-03-14T09:54:27.000Z</published>
    <updated>2021-03-14T10:14:18.185Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p>遠くには川 かすむ橋渡る電車揺れてもここは靜か</p></li><li><p>屆かないこと分かったときには あなたのあの言葉</p></li></ul><blockquote><p>人たちはこの空飛ぶことは葉わないけど その代わり</p></blockquote><blockquote><p>いま流す涙は天に升りまた 雨となり還る</p></blockquote><ul><li><p>西風が吹く雲が流れて 木陰にツグミの顔が覗く</p></li><li><p>立ち止まる ほら 淡い影ひとつわたしの傍 のびる</p></li><li><p>そしてここに光が差す</p></li></ul><ul><li><p>飛び立つ鳥たち 追いかけ虹が架かる</p></li><li><p>少女が走ればその先 待つ人がいる</p></li><li><p>両手を伸ばすと最後のしずく落ちる</p></li><li><p>こぼれた涙は乾き 微笑みが戻る</p></li><li><p>桥の向こうから 茜に空が染まる</p></li><li><p>明日は広げた傘に陽の匂い集め</p></li><li><p>誰かが流した涙を空に帰す</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;&lt;p&gt;遠くには川 かすむ橋渡る電車揺れてもここは靜か&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;屆かないこと分かったときには あなたのあの言葉&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;人たちはこの空飛ぶことは葉わないけど その代わり&lt;/p&gt;
&lt;/
      
    
    </summary>
    
    
    
      <category term="Mood" scheme="http://www.orekiyuta.cn/tags/Mood/"/>
    
  </entry>
  
  <entry>
    <title>SSH Port Mapping</title>
    <link href="http://www.orekiyuta.cn/archives/SSHPortMapping/"/>
    <id>http://www.orekiyuta.cn/archives/SSHPortMapping/</id>
    <published>2021-02-03T16:28:34.000Z</published>
    <updated>2021-02-03T17:37:10.334Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Scene"><a href="#Scene" class="headerlink" title="Scene"></a>Scene</h2><ol><li><ul><li>正常来说在服务器部署了一个服务，要访问该服务得用该云服务器 ip + 端口</li><li>然后去云服务器商设置开放端口，最后才能访问</li><li>但是，我们只是想随手用一下而已，又懒得去开放端口</li><li>这种时候可以用 SSH 端口映射</li></ul></li></ol><hr><ol start="2"><li><ul><li>我们想从公网去访问局域网内部的服务</li><li>也可以利用 SSH 端口映射 把 云服务器的请求转发到 局域网内部设备里</li></ul></li></ol><hr><ol start="3"><li><ul><li>不同子网之间的访问</li><li>内网穿透原理应该也是差不多</li></ul></li></ol><a id="more"></a><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><h3 id="本地端口转发-从本地访问公网内部子网服务"><a href="#本地端口转发-从本地访问公网内部子网服务" class="headerlink" title="本地端口转发-从本地访问公网内部子网服务"></a>本地端口转发-从本地访问公网内部子网服务</h3><ul><li>这里的操作视角为 本机 -&gt; 云服务器</li><li>这里的用户视角为 本机或处于同一网络下的机器 -&gt; 云服务器</li><li><code>ssh root@ip</code> 正常登录服务器 </li><li><code>ssh -L 2222:localhost:8080 root@ip</code> 这里就相当于把本机的 2222 端口 转发到 云服务器的 8080 端口<ul><li><code>ssh -L 本机地址:云服务器内网地址 root@ip</code></li><li>2222 其实是 localhost:2222 本机</li><li>而 localhost:8080 指的是 服务器内网中该服务器的地址</li><li>这个转发会在退出服务器登录时失效</li></ul></li><li><code>ssh -L 192.168.1.200:2222:localhost:8080 root@ip</code> </li><li>最后，就可以使得与本机处于同一网段的机器一起使用该地址转发到 云服务器的 8080 端口</li></ul><h3 id="远程端口转发-从公网访问与本机不在同一网段的服务"><a href="#远程端口转发-从公网访问与本机不在同一网段的服务" class="headerlink" title="远程端口转发-从公网访问与本机不在同一网段的服务"></a>远程端口转发-从公网访问与本机不在同一网段的服务</h3><ul><li>这里的操作视角为 远端子网机器 -&gt; 云服务器</li><li>这里的用户视角为 用户机器 -&gt; 云服务器 -&gt; 远端子网机器</li><li><p><code>ssh -R 3333:10.10.10.254:7777 root@ip</code> 这里意思就是将云服务器的端口 转发到 远端子网机器的 3333 端口 </p><ul><li><code>ssh -R 云服务器内网地址:远端子网机器地址 root@ip</code></li><li>3333 就是 云服务器的 localhost:3000</li><li>10.10.10.254:7777 为远端子网机器的地址</li><li>执行该命令后可用 <code>netstat -anp | grep 3333</code> 查看是否启用了监听该端口的服务</li></ul></li><li><p>当然这样还不行，问题在于安全问题，不能随意把远程端口开放了</p><ul><li>SSH 默认把该操作关闭了</li></ul></li><li>修改配置，开放该操作</li><li><code>vim /etc/ssh/sshd_config</code><pre><code class="diff"><span class="deletion">-#GatewayPorts no</span><span class="addition">+GatewayPorts yes</span></code></pre></li><li><code>systemctl restart sshd</code>  </li><li><code>ssh -R 0.0.0.0:3333:10.10.10.254:7777 root@ip</code> </li><li><code>netstat -anp | grep 3333</code> 再次查看</li><li>当然同时还要在云服务器商设置里把 3333 端口开放</li><li>最后，就可以通过 云服务器公网 ip + 端口 访问到 远程子网的机器里的端口服务了</li></ul><h3 id="访问不同网络下的设备-两者结合"><a href="#访问不同网络下的设备-两者结合" class="headerlink" title="访问不同网络下的设备-两者结合"></a>访问不同网络下的设备-两者结合</h3><ul><li>在前面两个的基础上，远程机器设置转发，本地机器也设置转发</li><li>就可以达到，利用处于公网的云服务器作为中介去访问不同网络下的机器</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Scene&quot;&gt;&lt;a href=&quot;#Scene&quot; class=&quot;headerlink&quot; title=&quot;Scene&quot;&gt;&lt;/a&gt;Scene&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;ul&gt;
&lt;li&gt;正常来说在服务器部署了一个服务，要访问该服务得用该云服务器 ip + 端口&lt;/li&gt;
&lt;li&gt;然后去云服务器商设置开放端口，最后才能访问&lt;/li&gt;
&lt;li&gt;但是，我们只是想随手用一下而已，又懒得去开放端口&lt;/li&gt;
&lt;li&gt;这种时候可以用 SSH 端口映射&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;&lt;ul&gt;
&lt;li&gt;我们想从公网去访问局域网内部的服务&lt;/li&gt;
&lt;li&gt;也可以利用 SSH 端口映射 把 云服务器的请求转发到 局域网内部设备里&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;&lt;ul&gt;
&lt;li&gt;不同子网之间的访问&lt;/li&gt;
&lt;li&gt;内网穿透原理应该也是差不多&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
    
      <category term="Linux" scheme="http://www.orekiyuta.cn/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Bitwarden On Docker</title>
    <link href="http://www.orekiyuta.cn/archives/bitwardenOnDocker/"/>
    <id>http://www.orekiyuta.cn/archives/bitwardenOnDocker/</id>
    <published>2021-02-02T15:32:12.000Z</published>
    <updated>2021-02-02T17:12:16.971Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yum install docker</span><br><span class="line"><span class="comment"># ------</span></span><br><span class="line">su root</span><br><span class="line">systemctl <span class="built_in">enable</span> docker</span><br><span class="line">systemctl start docker</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure></div><h2 id="Portainer"><a href="#Portainer" class="headerlink" title="Portainer"></a>Portainer</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo docker pull portainer/portainer</span><br><span class="line">sudo docker volume create portainer_data</span><br><span class="line">sudo docker run -d -p 9000:9000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer</span><br></pre></td></tr></table></figure></div><h2 id="Bitwarden"><a href="#Bitwarden" class="headerlink" title="Bitwarden"></a>Bitwarden</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull bitwardenrs/server:latest</span><br><span class="line">docker run -d --name bitwarden -v /var/run/bitwarden/:/data/ -p 80:9001 bitwardenrs/server:latest</span><br></pre></td></tr></table></figure></div><a id="more"></a><h2 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h2><h3 id="Job-for-docker-service-failed-because-the-control-process-exited-with-error-code-See-“systemctl-status-docker-service”-and-“journalctl-xe”-for-details"><a href="#Job-for-docker-service-failed-because-the-control-process-exited-with-error-code-See-“systemctl-status-docker-service”-and-“journalctl-xe”-for-details" class="headerlink" title="Job for docker.service failed because the control process exited with error code. See “systemctl status docker.service” and “journalctl -xe” for details."></a>Job for docker.service failed because the control process exited with error code. See “systemctl status docker.service” and “journalctl -xe” for details.</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm /etc/docker/daemon.json</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure></div><h3 id="Image-accelerator"><a href="#Image-accelerator" class="headerlink" title="Image accelerator"></a>Image accelerator</h3><ul><li><a href="https://cr.console.aliyun.com/cn-beijing/instances/mirrors" target="_blank" rel="noopener">https://cr.console.aliyun.com/cn-beijing/instances/mirrors</a></li></ul><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl cat docker | grep <span class="string">'\-\-registry\-mirror'</span></span><br><span class="line">sudo nano /etc/docker/daemon.json</span><br></pre></td></tr></table></figure></div><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"registry-mirrors"</span>: [<span class="string">"this link from aliyun"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure></div><h2 id="Refer"><a href="#Refer" class="headerlink" title="Refer"></a>Refer</h2><ul><li><a href="https://bitwarden.com/download/" target="_blank" rel="noopener">bitwarden</a></li><li><a href="https://github.com/dani-garcia/bitwarden_rs" target="_blank" rel="noopener">dani-garcia/bitwarden_rs</a></li><li><a href="https://bitwarden.com/help/article/install-on-premise/" target="_blank" rel="noopener">Install and Deploy</a></li><li><a href="https://hub.docker.com/r/bitwarden/setup" target="_blank" rel="noopener">bitwarden/setup</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Docker&quot;&gt;&lt;a href=&quot;#Docker&quot; class=&quot;headerlink&quot; title=&quot;Docker&quot;&gt;&lt;/a&gt;Docker&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum install docker&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;su root&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;systemctl &lt;span class=&quot;built_in&quot;&gt;enable&lt;/span&gt; docker&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;systemctl start docker&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;systemctl restart docker&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Portainer&quot;&gt;&lt;a href=&quot;#Portainer&quot; class=&quot;headerlink&quot; title=&quot;Portainer&quot;&gt;&lt;/a&gt;Portainer&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo docker pull portainer/portainer&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo docker volume create portainer_data&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo docker run -d -p 9000:9000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Bitwarden&quot;&gt;&lt;a href=&quot;#Bitwarden&quot; class=&quot;headerlink&quot; title=&quot;Bitwarden&quot;&gt;&lt;/a&gt;Bitwarden&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker pull bitwardenrs/server:latest&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;docker run -d --name bitwarden -v /var/run/bitwarden/:/data/ -p 80:9001 bitwardenrs/server:latest&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
    
      <category term="Docker" scheme="http://www.orekiyuta.cn/tags/Docker/"/>
    
      <category term="Bitwarden" scheme="http://www.orekiyuta.cn/tags/Bitwarden/"/>
    
  </entry>
  
  <entry>
    <title>Python Dependency Separation</title>
    <link href="http://www.orekiyuta.cn/archives/pythonDependencySeparation/"/>
    <id>http://www.orekiyuta.cn/archives/pythonDependencySeparation/</id>
    <published>2021-01-30T20:53:29.000Z</published>
    <updated>2021-02-02T18:27:56.591Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Scene"><a href="#Scene" class="headerlink" title="Scene"></a>Scene</h2><ul><li>由于每个项目之间的引入的依赖版本不同，并且有的依赖库还难以获取</li><li>因此在开发时，需要把依赖给保存下来，并且指明依赖的版本</li></ul><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><h3 id="freeze"><a href="#freeze" class="headerlink" title="freeze"></a>freeze</h3><ul><li><code>pip freeze &gt; requirements.txt</code></li><li>使用这个命令可以导出当前环境的所有依赖</li></ul><h3 id="pipreqs"><a href="#pipreqs" class="headerlink" title="pipreqs"></a>pipreqs</h3><ul><li><code>pip install pipreqs</code></li><li><code>pipreqs ./</code> 切换到项目根目录下执行，导出当前目录所引用的依赖</li><li><code>pipreqs ./ --encoding==utf-8</code></li><li><code>pipreqs ./ --encoding==utf-8 --force</code></li></ul><h3 id="venv"><a href="#venv" class="headerlink" title="venv"></a>venv</h3><ul><li>使用 python 的虚拟环境  <a id="more"></a><ul><li><code>python -m venv -h</code></li><li><code>python -m venv venvdemo</code> 创建虚拟环境</li><li>找到虚拟环境的文件夹，进入 Scripts 目录<ul><li><code>activate</code> 激活虚拟环境</li><li><code>activate</code> 退出虚拟环境</li></ul></li><li>所谓的激活虚拟环境，只不过是把当前系统的环境变量指向该虚拟环境</li><li>在环境变量中，一个变量先找到哪个就算哪个</li><li><img src="/images/pythonDependencySeparation/Snipaste_2021-02-01_00-39-18.png" alt></li><li>如图所示，激活虚拟环境时，会把该虚拟环境路径放在最前面，因此当前 python 的 path 就指向这个路径 ; 后面的 path 就不生效</li><li>激活虚拟环境后，可执行 <code>pip list</code> 查看当前的依赖库</li><li>激活虚拟环境后，执行的 <code>pip install</code> 都是装到该虚拟环境的目录里的</li><li>在 IDE 工具中 ,比如 PyCharm 中,直接把项目设置指向虚拟变量路径即可，本质就是改环境变量的 PATH</li></ul></li><li>迁移 虚拟环境<ul><li>在激活虚拟环境下，导出当前环境依赖库</li><li><code>pip freeze &gt; requirements.txt</code></li></ul></li></ul><h2 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h2><ul><li>虚拟环境的使用还是很有必要的，</li><li>因为安装一个依赖的时候，很多时候是会把指定依赖与其相关的其他依赖都安装</li><li>而卸载的时候只卸载了指定的依赖库</li><li><img src="/images/pythonDependencySeparation/Snipaste_2021-02-01_00-55-30.png" alt></li><li>如果不控制一下依赖库，久而久之就很难管理了</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Scene&quot;&gt;&lt;a href=&quot;#Scene&quot; class=&quot;headerlink&quot; title=&quot;Scene&quot;&gt;&lt;/a&gt;Scene&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;由于每个项目之间的引入的依赖版本不同，并且有的依赖库还难以获取&lt;/li&gt;
&lt;li&gt;因此在开发时，需要把依赖给保存下来，并且指明依赖的版本&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Solution&quot;&gt;&lt;a href=&quot;#Solution&quot; class=&quot;headerlink&quot; title=&quot;Solution&quot;&gt;&lt;/a&gt;Solution&lt;/h2&gt;&lt;h3 id=&quot;freeze&quot;&gt;&lt;a href=&quot;#freeze&quot; class=&quot;headerlink&quot; title=&quot;freeze&quot;&gt;&lt;/a&gt;freeze&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;pip freeze &amp;gt; requirements.txt&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;使用这个命令可以导出当前环境的所有依赖&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;pipreqs&quot;&gt;&lt;a href=&quot;#pipreqs&quot; class=&quot;headerlink&quot; title=&quot;pipreqs&quot;&gt;&lt;/a&gt;pipreqs&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;pip install pipreqs&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pipreqs ./&lt;/code&gt; 切换到项目根目录下执行，导出当前目录所引用的依赖&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pipreqs ./ --encoding==utf-8&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pipreqs ./ --encoding==utf-8 --force&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;venv&quot;&gt;&lt;a href=&quot;#venv&quot; class=&quot;headerlink&quot; title=&quot;venv&quot;&gt;&lt;/a&gt;venv&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;使用 python 的虚拟环境
    
    </summary>
    
    
    
      <category term="Python" scheme="http://www.orekiyuta.cn/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Django Run</title>
    <link href="http://www.orekiyuta.cn/archives/djangoRun/"/>
    <id>http://www.orekiyuta.cn/archives/djangoRun/</id>
    <published>2021-01-28T12:03:52.000Z</published>
    <updated>2021-01-28T16:58:16.926Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h2 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h2><h3 id="Error-WinError-10013-以一种访问权限不允许的方式做了一个访问套接字的尝试。"><a href="#Error-WinError-10013-以一种访问权限不允许的方式做了一个访问套接字的尝试。" class="headerlink" title="Error: [WinError 10013] 以一种访问权限不允许的方式做了一个访问套接字的尝试。"></a>Error: [WinError 10013] 以一种访问权限不允许的方式做了一个访问套接字的尝试。</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Starting development server at http://127.0.0.1:8000/</span><br><span class="line">Quit the server with CTRL-BREAK.</span><br><span class="line">Error: [WinError 10013] 以一种访问权限不允许的方式做了一个访问套接字的尝试。</span><br></pre></td></tr></table></figure></div><ul><li>端口被占用，关闭被占用端口的程序</li><li><code>netstat -ano|findstr 8000</code></li><li><code>tasklist | findstr pid号</code></li><li><code>taskkill /pid pid号 /f</code></li></ul><p><img src="/images/djangoRun/Snipaste_2021-01-28_20-07-56.png" alt></p><ul><li>或者改端口<br><img src="/images/djangoRun/Snipaste_2021-01-28_20-10-41.png" alt></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;Other&quot;&gt;&lt;a href=&quot;#Other&quot; class=&quot;headerlink&quot; title=&quot;Other&quot;&gt;&lt;/a&gt;Other&lt;/h2&gt;&lt;h3 id=&quot;Error-WinError-10013-以一种访问权限不允许的方式做
      
    
    </summary>
    
    
    
      <category term="Django" scheme="http://www.orekiyuta.cn/tags/Django/"/>
    
      <category term="Python" scheme="http://www.orekiyuta.cn/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Python get function from String</title>
    <link href="http://www.orekiyuta.cn/archives/pythonGetFunctionFromString/"/>
    <id>http://www.orekiyuta.cn/archives/pythonGetFunctionFromString/</id>
    <published>2021-01-24T18:02:46.000Z</published>
    <updated>2021-01-24T18:17:18.948Z</updated>
    
    <content type="html"><![CDATA[<h2 id="从变量中获取对象的函数并执行"><a href="#从变量中获取对象的函数并执行" class="headerlink" title="从变量中获取对象的函数并执行"></a>从变量中获取对象的函数并执行</h2><ul><li><p>单纯的执行方法可以用 eval()、locals()、globals()</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eval(func)() <span class="comment"># func 为变量值</span></span><br><span class="line">locals()[func]()</span><br><span class="line">globals()[func]()</span><br></pre></td></tr></table></figure></div></li><li><p>而从对象中执行方法用 <code>__getattribute__</code></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome.__getattribute__(itemParser) <span class="comment"># 对象.__getattribute__(变量值)</span></span><br></pre></td></tr></table></figure></div></li></ul><a id="more"></a><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><ul><li><p>从变量从读取函数名并执行,提高复用度</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">config = [&#123;<span class="string">'name'</span>: <span class="string">'qncyw'</span>, <span class="string">'url'</span>: <span class="string">'https://www.qncyw.com/site/signup'</span>,</span><br><span class="line">           <span class="string">'parser'</span>: <span class="string">'selector'</span>,</span><br><span class="line">           <span class="string">'phoneInputParser'</span>: <span class="string">'#username'</span>,</span><br><span class="line">           <span class="string">'sendButtonParser'</span>: <span class="string">'#btnSendCode'</span>&#125;,</span><br><span class="line">          &#123;<span class="string">'name'</span>: <span class="string">'360doc'</span>, <span class="string">'url'</span>: <span class="string">'http://www.360doc.com/register.aspx'</span>,</span><br><span class="line">           <span class="string">'parser'</span>: <span class="string">'selector'</span>,</span><br><span class="line">           <span class="string">'phoneInputParser'</span>: <span class="string">'#signMobileName'</span>,</span><br><span class="line">           <span class="string">'sendButtonParser'</span>: <span class="string">'#sign_sendcode'</span>&#125;,</span><br><span class="line">          &#123;<span class="string">'name'</span>: <span class="string">'iwgame'</span>, <span class="string">'url'</span>: <span class="string">'http://passport.iwgame.com/reg/account/regpage.do'</span>,</span><br><span class="line">           <span class="string">'parser'</span>: <span class="string">'xpath'</span>,</span><br><span class="line">           <span class="string">'phoneInputParser'</span>: <span class="string">'//*[@name="identityId"]'</span>,</span><br><span class="line">           <span class="string">'sendButtonParser'</span>: <span class="string">'//*[@id="regPersonalForm"]/ul/li[5]/div[1]/em/a'</span>&#125;,</span><br><span class="line">          ]</span><br><span class="line">          </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">eboo</span><span class="params">(chrome)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> config:</span><br><span class="line">        itemName = item[<span class="string">'name'</span>]</span><br><span class="line">        itemUrl = item[<span class="string">'url'</span>]</span><br><span class="line">        itemParser = <span class="string">''</span></span><br><span class="line">        setDateTime = time.strftime(<span class="string">'%Y-%m-%d %H:%M:%S'</span>, time.localtime(time.time()))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            chrome.get(itemUrl)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> item[<span class="string">'parser'</span>] == <span class="string">'selector'</span>:</span><br><span class="line">                itemParser = <span class="string">'find_element_by_css_selector'</span></span><br><span class="line">            <span class="keyword">elif</span> item[<span class="string">'parser'</span>] == <span class="string">'xpath'</span>:</span><br><span class="line">                itemParser = <span class="string">'find_element_by_xpath'</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># chrome 对象通过 __getattribute__ 方法去执行名为 itemParser 变量值的函数</span></span><br><span class="line">            chrome.__getattribute__(itemParser)(item[<span class="string">'phoneInputParser'</span>]).send_keys(phoneNum)</span><br><span class="line">            chrome.__getattribute__(itemParser)(item[<span class="string">'sendButtonParser'</span>]).click()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> NoSuchElementException <span class="keyword">as</span> error:</span><br><span class="line">            print(<span class="string">f"<span class="subst">&#123;itemName&#125;</span> ---&gt; <span class="subst">&#123;error&#125;</span>"</span>)</span><br><span class="line">            chrome.get_screenshot_as_file(<span class="string">'./error/'</span> + itemName + <span class="string">'_'</span> + setDateTime + <span class="string">'.png'</span>)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            print(<span class="string">f"<span class="subst">&#123;itemName&#125;</span> already completed at <span class="subst">&#123;setDateTime&#125;</span>"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ChromeOpen</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    headers = <span class="string">'user-agent="Mozilla/5.0 (Windows NT 10.0; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0" '</span></span><br><span class="line">    options = ChromeOptions()</span><br><span class="line">    options.add_argument(headers)</span><br><span class="line">    chrome = Chrome(options=options)</span><br><span class="line">    <span class="keyword">return</span> chrome</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">chrome_open = ChromeOpen()</span><br><span class="line">eboo(chrome_open)</span><br></pre></td></tr></table></figure></div></li><li><p>👉 <a href="https://segmentfault.com/a/1190000010476065" target="_blank" rel="noopener">Python 通过字符串调用函数或方法</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;从变量中获取对象的函数并执行&quot;&gt;&lt;a href=&quot;#从变量中获取对象的函数并执行&quot; class=&quot;headerlink&quot; title=&quot;从变量中获取对象的函数并执行&quot;&gt;&lt;/a&gt;从变量中获取对象的函数并执行&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;单纯的执行方法可以用 eval()、locals()、globals()&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;eval(func)() &lt;span class=&quot;comment&quot;&gt;# func 为变量值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;locals()[func]()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;globals()[func]()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;而从对象中执行方法用 &lt;code&gt;__getattribute__&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;chrome.__getattribute__(itemParser) &lt;span class=&quot;comment&quot;&gt;# 对象.__getattribute__(变量值)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
    
      <category term="Python" scheme="http://www.orekiyuta.cn/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>MySQL Split String By Procedure</title>
    <link href="http://www.orekiyuta.cn/archives/mysqlSplitStringByProcedure/"/>
    <id>http://www.orekiyuta.cn/archives/mysqlSplitStringByProcedure/</id>
    <published>2021-01-20T16:17:23.000Z</published>
    <updated>2021-01-21T14:24:23.870Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Scene"><a href="#Scene" class="headerlink" title="Scene"></a>Scene</h2><ul><li>有这样一个场景，需要把一个表中的某个字段内的字符串分割成列</li></ul><table><thead><tr><th style="text-align:center">roleCode</th><th style="text-align:center">users</th></tr></thead><tbody><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20865</td><td style="text-align:center">xb,guojinyu,jiangyuan,ly_bmcc,wwm,lck,wusuihua</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20866</td><td style="text-align:center">zlj,mashaomeng</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20867</td><td style="text-align:center">tianye2</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20869</td><td style="text-align:center">wangyinju,liu_yan</td></tr></tbody></table><ul><li>就是把上面的表格拆分成下面的样子</li></ul><table><thead><tr><th style="text-align:center">roleCode</th><th style="text-align:center">users</th></tr></thead><tbody><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20865</td><td style="text-align:center">xb</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20865</td><td style="text-align:center">guojinyu</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20865</td><td style="text-align:center">jiangyuan</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20865</td><td style="text-align:center">ly_bmcc</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20865</td><td style="text-align:center">wwm</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20865</td><td style="text-align:center">lck</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20865</td><td style="text-align:center">wusuihua</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20866</td><td style="text-align:center">zlj</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20866</td><td style="text-align:center">mashaomeng</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20867</td><td style="text-align:center">tianye2</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20869</td><td style="text-align:center">wangyinju</td></tr><tr><td style="text-align:center">4dc51344e6674c03ae0a176d3d0ae14e_20869</td><td style="text-align:center">liu_yan</td></tr></tbody></table><a id="more"></a><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ul><li>因为要用到循环，所以得用存储过程去解决这个问题<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> i <span class="built_in">INT</span>;</span><br><span class="line">    <span class="keyword">DECLARE</span> j <span class="built_in">INT</span>;</span><br><span class="line">    <span class="comment">-- 创建表存储结果</span></span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> <span class="keyword">result</span>(roleCode <span class="built_in">VARCHAR</span>(<span class="number">255</span>),<span class="keyword">users</span> <span class="built_in">VARCHAR</span>(<span class="number">255</span>));</span><br><span class="line">    <span class="comment">-- 使用临时表执行速度会快些</span></span><br><span class="line">    <span class="comment">-- CREATE TEMPORARY TABLE IF NOT EXISTS result(roleCode VARCHAR(255),users VARCHAR(255));</span></span><br><span class="line">    <span class="comment">-- 获取行数，用于第一层循环</span></span><br><span class="line">    <span class="keyword">SET</span> @cols_num = (<span class="keyword">SELECT</span> <span class="keyword">count</span>(<span class="keyword">users</span>) <span class="keyword">FROM</span> <span class="string">`user`</span>); </span><br><span class="line"><span class="keyword">SET</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    WHILE i &lt; @cols_num DO</span><br><span class="line">        <span class="keyword">SET</span> j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">-- 获取 users 字段内的被 “,” 分割的字符串数目</span></span><br><span class="line">        <span class="comment">-- LENGTH(users) - LENGTH(REPLACE(users,',',''))+1 AS userNums</span></span><br><span class="line">        <span class="comment">-- 将字符串数目赋给变量 @str_num ,用于第二层循环</span></span><br><span class="line">        <span class="comment">-- 同时取得当前记录的 roleCode,把值赋给变量 @roleCode</span></span><br><span class="line">        <span class="keyword">SELECT</span> roleCode,<span class="keyword">LENGTH</span>(<span class="keyword">users</span>) - <span class="keyword">LENGTH</span>(<span class="keyword">REPLACE</span>(<span class="keyword">users</span>,<span class="string">','</span>,<span class="string">''</span>))+<span class="number">1</span> <span class="keyword">AS</span> userNums  </span><br><span class="line">        <span class="keyword">INTO</span> @roleCode,@str_num <span class="keyword">FROM</span> <span class="string">`user`</span> <span class="keyword">LIMIT</span> i,<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        WHILE j &lt; @str_num DO</span><br><span class="line">            <span class="comment">-- 取得当前查询的记录的 users 字段被分割的最后一个字符串</span></span><br><span class="line">            <span class="keyword">SELECT</span> SUBSTRING_INDEX(SUBSTRING_INDEX(<span class="keyword">users</span>,<span class="string">','</span>,j+<span class="number">1</span>),<span class="string">','</span>,<span class="number">-1</span>) <span class="keyword">AS</span> <span class="keyword">users</span> </span><br><span class="line">            <span class="keyword">INTO</span> @<span class="keyword">users</span> <span class="keyword">FROM</span> <span class="string">`user`</span> <span class="keyword">LIMIT</span> i,<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">result</span>(roleCode,<span class="keyword">users</span>) <span class="keyword">VALUES</span> (@roleCode,@<span class="keyword">users</span>);</span><br><span class="line">                        </span><br><span class="line">            <span class="keyword">SET</span> j = j+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">WHILE</span>;</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">SET</span> i = i+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">WHILE</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 查询结果</span></span><br><span class="line">    <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">result</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure></div></li></ul><h2 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h2><ul><li>如果要逆向还原，只需执行下面语句即可<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> roleCode,<span class="keyword">GROUP_CONCAT</span>(<span class="keyword">users</span>) <span class="keyword">AS</span> <span class="keyword">users</span> <span class="keyword">FROM</span> <span class="keyword">result</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> roleCode;</span><br></pre></td></tr></table></figure></div></li></ul><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><p>存储过程基本用法</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> test_tbl;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test_tbl (<span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>), <span class="keyword">status</span> <span class="built_in">int</span>(<span class="number">2</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> test_tbl <span class="keyword">values</span>(<span class="string">'abc'</span>, <span class="number">1</span>),(<span class="string">'edf'</span>, <span class="number">2</span>),(<span class="string">'xyz'</span>, <span class="number">3</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">procedure</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> pro_test_3;</span><br><span class="line">delimiter //</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> pro_test_3()</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="comment">--  方式 1</span></span><br><span class="line">    <span class="keyword">DECLARE</span> cnt <span class="built_in">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">into</span> cnt <span class="keyword">from</span> test_tbl;</span><br><span class="line">    <span class="keyword">select</span> cnt;</span><br><span class="line"> </span><br><span class="line"><span class="comment">--  方式 2</span></span><br><span class="line">    <span class="keyword">set</span> @cnt = (<span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> test_tbl);</span><br><span class="line">    <span class="keyword">select</span> @cnt;</span><br><span class="line"></span><br><span class="line"><span class="comment">--  方式 3</span></span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">into</span> @cnt1 <span class="keyword">from</span> test_tbl;</span><br><span class="line">    <span class="keyword">select</span> @cnt1;</span><br><span class="line"></span><br><span class="line"><span class="comment">--  多个列的情况下似乎只能用 into 方式</span></span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">max</span>(<span class="keyword">status</span>), <span class="keyword">avg</span>(<span class="keyword">status</span>) <span class="keyword">into</span> @<span class="keyword">max</span>, @<span class="keyword">avg</span> <span class="keyword">from</span> test_tbl;</span><br><span class="line">    <span class="keyword">select</span> @<span class="keyword">max</span>, @<span class="keyword">avg</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">call</span> pro_test_3();</span><br></pre></td></tr></table></figure></div></li><li><p>👉 <a href="https://www.cnblogs.com/qdhxhz/category/1222307.html" target="_blank" rel="noopener">MySQL（7）—存储过程</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Scene&quot;&gt;&lt;a href=&quot;#Scene&quot; class=&quot;headerlink&quot; title=&quot;Scene&quot;&gt;&lt;/a&gt;Scene&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;有这样一个场景，需要把一个表中的某个字段内的字符串分割成列&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;roleCode&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;users&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20865&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;xb,guojinyu,jiangyuan,ly_bmcc,wwm,lck,wusuihua&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20866&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;zlj,mashaomeng&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20867&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;tianye2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20869&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;wangyinju,liu_yan&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;就是把上面的表格拆分成下面的样子&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;roleCode&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;users&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20865&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;xb&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20865&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;guojinyu&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20865&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;jiangyuan&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20865&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;ly_bmcc&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20865&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;wwm&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20865&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;lck&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20865&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;wusuihua&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20866&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;zlj&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20866&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;mashaomeng&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20867&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;tianye2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20869&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;wangyinju&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;4dc51344e6674c03ae0a176d3d0ae14e_20869&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;liu_yan&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
    
    </summary>
    
    
    
      <category term="MySQL" scheme="http://www.orekiyuta.cn/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQL Sync to Mariadb</title>
    <link href="http://www.orekiyuta.cn/archives/mysqlSyncToMariadb/"/>
    <id>http://www.orekiyuta.cn/archives/mysqlSyncToMariadb/</id>
    <published>2021-01-20T12:43:04.000Z</published>
    <updated>2021-01-20T13:08:24.882Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Unkown-collation-’utf8mb4-0900-ai-ci’"><a href="#Unkown-collation-’utf8mb4-0900-ai-ci’" class="headerlink" title="Unkown collation:’utf8mb4_0900_ai_ci’"></a>Unkown collation:’utf8mb4_0900_ai_ci’</h2><ul><li>把 MySQL 数据同步到 Mariadb 出现排序规则不一致</li><li>MySQL 数据库默认字符集和排序规则<br><img src="/images/mysqlSyncToMariadb/Snipaste_2021-01-20_21-07-07.png" alt></li><li>MySQL 转储的 SQL 文件默认<code>DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci</code></li><li>Mariadb 数据库默认字符集和排序规则<br><img src="/images/mysqlSyncToMariadb/Snipaste_2021-01-20_20-47-17.png" alt></li><li>Mariadb 转储的 SQL 文件默认<code>DEFAULT CHARSET=utf8mb4;</code></li></ul><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ul><li>在 Mariadb 中排序规则没有 utf8mb4_0900_ai_ci </li><li>解决方法是 ：转储 MySQL 数据，然后把 SQL 文件里的 <code>COLLATE=utf8mb4_0900_ai_ci</code>全部替换成 <code>COLLATE=utf8mb4_general_ci</code> 即可<ul><li>或者是把 SQL 文件里的 <code>COLLATE=utf8mb4_0900_ai_ci</code> 去掉</li></ul></li><li>总的来说就是把设置配成一致就可以了</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Unkown-collation-’utf8mb4-0900-ai-ci’&quot;&gt;&lt;a href=&quot;#Unkown-collation-’utf8mb4-0900-ai-ci’&quot; class=&quot;headerlink&quot; title=&quot;Unkown collation:’
      
    
    </summary>
    
    
    
      <category term="MySQL" scheme="http://www.orekiyuta.cn/tags/MySQL/"/>
    
      <category term="Mariadb" scheme="http://www.orekiyuta.cn/tags/Mariadb/"/>
    
  </entry>
  
</feed>
